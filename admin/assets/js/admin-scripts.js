(function(root){var Toggles=root["Toggles"]=function(el,opts){var self=this;if(el.data("toggles")&&typeof opts==="boolean"){el.data("toggles").toggle(opts);return}var dataAttr=["drag","click","width","height","animate","easing","type"];var dataOpts={};for(var i=0;i<dataAttr.length;i++){var opt=el.data("toggle-"+dataAttr[i]);if(typeof opt!=="undefined")dataOpts[dataAttr[i]]=opt}opts=self.opts=$.extend({drag:true,click:true,text:{on:"ON",off:"OFF"},on:false,animate:250,easing:"swing",checkbox:null,clicker:null,width:50,height:20,type:"compact"},opts||{},dataOpts);self.el=el;self["active"]=opts["on"];el.data("toggles",self);self.selectType=opts["type"]==="select";self.checkbox=$(opts["checkbox"]);if(opts["clicker"])self.clicker=$(opts["clicker"]);self.createEl();self.bindEvents()};Toggles.prototype.createEl=function(){var self=this;var height=self.el.height();var width=self.el.width();if(!height)self.el.height(height=self.opts["height"]);if(!width)self.el.width(width=self.opts["width"]);self.h=height;self.w=width;var div=function(name){return $('<div class="toggle-'+name+'">')};self.els={slide:div("slide"),inner:div("inner"),on:div("on"),off:div("off"),blob:div("blob")};var halfHeight=height/2;var onOffWidth=width-halfHeight;var isSelect=self.selectType;self.els.on.css({height:height,width:onOffWidth,textIndent:isSelect?"":-halfHeight,lineHeight:height+"px"}).html(self.opts["text"]["on"]);self.els.off.css({height:height,width:onOffWidth,marginLeft:isSelect?"":-halfHeight,textIndent:isSelect?"":halfHeight,lineHeight:height+"px"}).html(self.opts["text"]["off"]).addClass("active");self.els.blob.css({height:height,width:height,marginLeft:-halfHeight});self.els.inner.css({width:width*2-height,marginLeft:isSelect||self["active"]?0:-width+height});if(self.selectType){self.els.slide.addClass("toggle-select");self.el.css("width",onOffWidth*2);self.els.blob.hide()}self.els.inner.append(self.els.on,self.els.blob,self.els.off);self.els.slide.html(self.els.inner);self.el.html(self.els.slide)};Toggles.prototype.bindEvents=function(){var self=this;var clickHandler=function(e){if(e["target"]!==self.els.blob[0]||!self.opts["drag"]){self.toggle()}};if(self.opts["click"]&&(!self.opts["clicker"]||!self.opts["clicker"].has(self.el).length)){self.el.on("click",clickHandler)}if(self.opts["clicker"]){self.opts["clicker"].on("click",clickHandler)}if(self.opts["drag"]&&!self.selectType)self.bindDrag()};Toggles.prototype.bindDrag=function(){var self=this;var diff;var slideLimit=(self.w-self.h)/4;var upLeave=function(e){self.el.off("mousemove");self.els.slide.off("mouseleave");self.els.blob.off("mouseup");if(!diff&&self.opts["click"]&&e.type!=="mouseleave"){self.toggle();return}var overBound=self["active"]?diff<-slideLimit:diff>slideLimit;if(overBound){self.toggle()}else{self.els.inner.stop().animate({marginLeft:self["active"]?0:-self.w+self.h},self.opts["animate"]/2)}}.bind(self);var wh=-self.w+self.h;self.els.blob.on("mousedown",function(e){diff=0;self.els.blob.off("mouseup");self.els.slide.off("mouseleave");var cursor=e.pageX;self.el.on("mousemove",self.els.blob,function(e){diff=e.pageX-cursor;var marginLeft;if(self["active"]){marginLeft=diff;if(diff>0)marginLeft=0;if(diff<wh)marginLeft=wh}else{marginLeft=diff+wh;if(diff<0)marginLeft=wh;if(diff>-wh)marginLeft=0}self.els.inner.css("margin-left",marginLeft)});self.els.blob.on("mouseup",upLeave);self.els.slide.on("mouseleave",upLeave)})};Toggles.prototype.toggle=function(state){var self=this;if(self["active"]===state)return;var active=self["active"]=!self["active"];self.el.data("toggle-active",active);self.els.off.toggleClass("active",!active);self.els.on.toggleClass("active",active);self.checkbox.prop("checked",active);self.el.trigger("toggle",active);if(self.selectType)return;var margin=active?0:-self.w+self.h;self.els.inner.stop().animate({marginLeft:margin},self.opts["animate"])};var factory=function($){$.fn["toggles"]=function(opts){return this.each(function(){new Toggles($(this),opts)})}};if(typeof define==="function"&&define["amd"]){define(["jquery"],factory)}else{factory(root["jQuery"]||root["Zepto"]||root["ender"]||root["$"]||$)}})(this);